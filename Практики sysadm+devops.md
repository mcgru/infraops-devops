Что должно сопровождать создание сервиса, чтобы не болела голова у сисадмина и девопса по поддержанию его работоспособности.

## Затравка (описание проблемы)

Устанавливаем сервис, настраиваем его (порты, доступ к сервису, пользователи, настройки памяти и хранилища), начинаем эксплуатировать. Но иногда то забудем настроить бакап, то забудем настроить HA-LB, то логи забудем настроить ротейтилку им и они засрут через полгода место, то настройку его сделаем "вручную" (без оркистратора), ну и мониторинг понятное дело - оставим напотом и забудем.
А потом, через N месяцев случается хня и нам (сисадминам) становится обидно, что или не сделали бакап вовремя, или бакап не проверили (а там хрень), или логи засрали всё место (так что сервис аж остановился), или логи засрали всё место по причине отсутствия мониторинга, или несмотря на то, что данные сохранились, но пропали учётные записи пользователей, работающих с данным сервисом...
Хотелось бы избавиться от этих неприятностей.

# Некоторые определения
(нет слова - нет знания)
### Сервис
Программный продукт, предоставляющий "наружу" (относительно себя) свои возможности через сетевой или локальный интерфейс (ipv4, unix).
Обладает настройками, кодом (своими библиотеками), может обладать хранилищем.
Способен взаимодействовать с другими сервисами (анонимная или персонифицированная внешняя интеграция).
### BLM (backup-logging-monitoring)
Основные элементы сопровождения сервиса со стороны сисадмина/девопса : резервное копирование (backup), обработка логов (logging), мониторинг и алёртинг (monitoring)

# Какие бывают приложения?
- обычные бинарники, для которых не требуются какие-либо конфиги, и которым не нужно сохранять своё состояние. например, `grep`. **grep<=()** (не владеет ничем)
- программы, для которых иногда хотелось бы настроить параметры запуска. например, `vim`, для котрого можно настроить `~/.vimrc` . **vim<=(configs)**
- программы или сервисы, которым сравнительно часто нужно менять конфгурацию (всего приложения или его частей), но которые не сохраняют своё состояние. например, `nginx`, у которого есть logs, которые хотелось бы куда-то сохранять для последующего анализа (цели мониторинга). **nginx<=(configs+logs)**
- приложения/сервисы, у которых есть конфигурация, которые пишут логи, и кроме этого сохраняют некие файлы. Но в целом приложение остаётся stateless. Однако, к задаче сохранения логов добавляется задача бакапирования файлов. **frontend<=(configs+logs+files)**
- сервисы, с конфигурацией, логами, файлами, но которые уже являются statefull, и подключаются к базе данных для хранения состояния. Бакапировать теперь нужно не только файлы, но и базу данных (вкупе с репликацией). И логгировать/мониторить требуется уже не только приложение, но и базу данных. **app<=(configs+files+logs+database)**

Вышеописанное касается отдельностоящих бинарников. Но всё то же само относится и к контейнерам, только добавляется ещё сохранение конфигурации запуска контейнеров.

## Рассмотрим приложение frontend+backend+db


Что ещё, кроме подъёма приложения (микро- или немикро- сервисного), нужно сделать, чтобы не волноваться про него в будущем?

	- Установка (бинарник, пакет ОС ПМ, отдельный докер-образ, докер-композ)
	- Настройка конфига:
		- Настройка параметров приложения
		- Настройка логгирования
		- Настройка хранилища файлов
		- Настройка коннекции к БД
		- Настройка (централизованного?) аутентификации/авторизации
	- Хелсчек при запуске
	- Условия рестарта (в композе или в системд)
	- Бакап БД
	- Репликация/бакап файлов
	- Логгирование наружу, репликация логов
	- Мониториг системы:
		- сбор системных метрик
		- сбор бизнес-метрик приложения
		- сбор метрик с сопутствующих сервисов
		- алёртинг
		- анализ трендов
	- Масштабирование
	- Отказоустойчивость
	- Настройка ресурсоёмкости (потребления ресурсов, performance tuning)
	- Тестирование бакапов

А вот в процессе жизни приложения - кроме обновления самого приложения и его компонентов (связанных с ним сервисов), нужно уделить внимание:

	  - Учения по отработке действий при возникновении критических ситуаций (по сигналу из мониторинга)
	  - Пересмотр метрик логов при изменении функционала
	  - Мониторинг логгирования и бакапирования

Каменты из канала Bash-days:
- Пререквизиты
- тогда уж ессли "на все деньги" - регламенты и требования к приложениям и сервисам для постановки на мониторинг. Списки ключевых метрик и их трешхолды, механизмы передачи метрик и логов, зоны ответственности при реагировании.
- Потому что приклад может отдавать несколько тысяч метрик, но только автор знает какие из них критические... Другими словами - приоритеты алертинга.
- из бэст практис - потрудились и в теле алерта (критического) помимо самого события прилетает сразу 2 ссылки с описанием что значит метрика и типовыми способами как чинить.

#### Управление енвирументами (envirooment)
Плохо, что два понятия назвали одним английским словом environment - и окружение процесс, и выдачное/выкаточное окружение всего сервиса - тестовое, разработческое, продуктовое. Посему предлагаю как-то извращённо разделить на два термина - энвайронмент (environment) и энвирумент (envirooment), имеющего псевдо-корень room (комната), как нечто отдельное, где творится действо, назвисимо от других "комнат".

Возможные варианты енвирументов:
	  - прод, продакшн, продуктовый
	  - стейдж, стейжовый, пре-релиз
	  - тестовый
	  - нагрузочный
	  - разработческий, девелоперский, дев

#### Управление конфигурациями 
###### развёртывание виртуалки/узла (оркестрация)
Приложение может быть развёрнуто:
- на bare metal (dedicated server)
- в виртуалке
- в контейнере
Для вариантов "bare metal / dedicated server" и "виртуалка" предварительно следует подготовить сервера - либо установить ОС, либо развернуть виртуалку (в облаке, из шаблона на местном сервере). Для виртуалок - оркестрация создания с использованием (например) terraform совместно с нужным provider'ом. Для bare metal - любая автоматизация: ansible, chef, puppet, salt.
Для варианта "в контейнере" - подготовка узла (хоста) входит в уже описанные варианты.


###### Terraform
Краткий реферат по использованию.


###### развёртывание приложения (оркестрация)
Автоматизация конфигурирования приложения проводится оркестраторами типа ansible, chef, puppet, salt. 
###### оркестрация секретами
ansible vault, docker (swarm) secrets, kubernetes secrets


#### BLM (backup+logging+monitoring) (для БД - backup+replica+test)

#### CICD (continuous integration+delivery)

#### тестирование (smoke, healthcheck, нагрузочное, регрессионное, юнит-тесты, интеграционное)

#### управление пользователями (zitadel? keycloak? authentik?)
#### управление рутинными задачами (kestra.io?)

#### внешние интеграции (почта?)


# Управление конфигурациями приклада


Далее...

# Некоторые определения
(нет слова - нет знания)
### Сервис
Программный продукт, предоставляющий "наружу" (относительно себя) свои возможности через сетевой или локальный интерфейс (ipv4, unix).
Обладает настройками, кодом (своими библиотеками), может обладать хранилищем.
Способен взаимодействовать с другими сервисами (анонимная или персонифицированная внешняя интеграция).
### BLM (backup-logging-monitoring)
Основные элементы сопровождения сервиса со стороны сисадмина/девопса : резервное копирование (backup), обработка логов (logging), мониторинг и алёртинг (monitoring)


# Комментарии

### Комментарии от Павла
* нужно квотировать после нагрузочного обязательно. 
* Кроме того обозначить метрики и триггеры алертов именно выделить в обязательное условие приема на саппорт (в прод).  Иначе головняки будут обязательно. 
* Также про бэкапы - нужно генерить сразу требования к описанию оных. Как то: Что именно бэкапим, каким методом: icrement, diff, full. Обязательно план восстановления с тестированием и итогами тестового восстановления.
* Это (шпаргалки по InfraOps) описано, понятное дело, чаще всего в релгаментах внутренних и регуляторке типа ЦБ, и прочем. В остальном в сети разровненная инфа, котора подразумевает наличие у админа здравого смысла и опыта коть какого-то
* Практики как таковые - ХЗ. Всё зависит от того, что бэкапить. Вангую, если важная data, database, то diff предпочтительнее, но дороже в хранении. Тут всё зависит от возможности, ресурсов и здравого смысла, опять же)) . Ну и регуляторки давления тоже.

### Комментарии от Александра
* (про сгенерённое ИИ) Нарм, только Swarm нинужон
* И я бы добавил InfraOps и выкинул бы Jenkins
* В Performance Tuning маловато...
* И что-нибудь про постмортемы еще нужно прикрутить и про алерты

# Ссылочки из канала

https://gitinsky.com/infra-ops
тут про термин InfraOps

https://roadmap.sh/r/application-deployment-and-management
Это я попросил ИИ накидать roadmap.sh - как заготовка плана - вышло зачотно.
(но я чуть позже нечаянно испортил внешний вид)

# Авторы
Иван Грушин и AI (заготовка roadmap.sh).
Дополнения и комментарии:  Дмитрий Николаев, Alex, Павел Тихонюк, Александр Чистяков.

# ====================


Ai-generated plan of learning.
https://roadmap.sh/r/application-deployment-and-management

## Fundamentals of application deployment

#### Какие бывают приложения?
- обычные бинарники, для которых не требуются какие-либо конфиги, и которым не нужно сохранять свой состояние. например, `grep`
- программы, для которых иногда хотелось бы настроить параметры запуска. например, `vim`, для котрого можно настроить `~/.vimrc`
- программы или сервисы, которым часто нужно менять конфгурацию (всего приложения или его частей), но которые не сохраняют своё состояние. например, nginx+logs
- frontend+logs+files
- app+logs+database
- docker containers vs binaries
#### Understanding software deployment
Приложения как бинарник и как контейнер
#### Application packaging standards
#### Deployment strategies
#### VCS: version control systems
#### Continuous Integration & continuous deployment (CI/CD)
#### Basics of Docker


## Infrastructure setup

#### Infrastructure basics
#### Infrastructure as a code (IaC, IaaC)
#### Understanding cloud platforms
#### Server configuration
#### Load balancing and auto-scaling
#### Containerization and virtualization


## Backup and recovery
#### Importance of backup and recovery
#### Data backup strategies
#### Backup software tools
#### Implementing automatic backups
#### Data recovery strategies
#### Validating and testing backups


## Implementing logging
#### Introduction to system logging
#### The log files and syslog standard
#### Log management tools
#### Centralized logging
#### Analyzing and managing logs
#### Log monitoring and alerting


## System and application monitoring
#### Monitoring basics
#### System monitoring tools
#### Application performance monitoring (APM)
#### Network monitoring
#### Cloud monitoring
#### Setting up monitoring dashboards

## User management
#### Understanding access control
#### Basics of user management
#### Implementing user authentication
#### Implementing user authorization
#### User role management
#### User priveledge auditing


## Security
#### Basics of information security
#### Working with firewalls
#### Implementing intrusion detection systems
#### Security connectivity with VPNs
#### Web security best practices
#### Cybersecurity awareness and practices


## Orchestration
#### Basics of orcestration
#### Cluster management and orchestration
#### Docker swarm
#### Kubernetes basics
#### Kubernetes deployment
#### Advanced kubernetes management


## Scripting and automation
#### Understanding scripting basics
#### Using bash for scripting
#### Python for automation
#### Using ansible for configuration management
#### Using Terraform for IaC
#### Using Jenkins for CI/CD automation


## Performance tuning
#### Basics of performance tuning
#### Optimizing database performance
#### Optimizing server performance
#### Application optimization
#### Network optimization
#### Implementing caching mechanisms



## Troubleshooting
#### Basics of troubleshooting
#### Network troubleshooting
#### System troubleshooting
#### Application troubleshooting
#### Troubleshooting common security issues
#### Documenting and reporting issues


## Maintenance and updates
#### Importance of regular maintenance
#### Planning and implementing updates
#### Managing downtimes
#### Patch management
#### Ensuring high availability (HA)
#### Lifecycle management
